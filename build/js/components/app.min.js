"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":_typeof(t))&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":_typeof(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),_send=require("./send.js"),_send2=_interopRequireDefault(_send),_users=require("./users.js"),_users2=_interopRequireDefault(_users),_messages=require("./messages.js"),_messages2=_interopRequireDefault(_messages),app=document.querySelector("#app"),ChatApp=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={inputValue:"",messages:[],users:[]},e.sendMessage=e.sendMessage.bind(e),e.updateValue=e.updateValue.bind(e),e.sendMessage=e.sendMessage.bind(e),e}return _inherits(t,e),_createClass(t,[{key:"updateValue",value:function(e){this.setState({inputValue:e.target.value})}},{key:"componentDidMount",value:function(){var e=this;this.socket=new WebSocket("ws://localhost:8080"),this.socket.onopen=function(){return e.onSocketOpen()},this.socket.onmessage=function(t){return e.onSocketData(t)},this.socket.onclose=function(t){return e.onSocketClose()}}},{key:"onSocketOpen",value:function(){var e=prompt("What is your name ?");""!==e&&this.socket.send(JSON.stringify({type:"connection",joined:e}))}},{key:"onSocketClose",value:function(){}},{key:"onSocketData",value:function(e){var t=JSON.parse(e.data),s=this.state.messages;"connection"===t.type?(s.push(t),this.setState({users:t.connections,messages:s})):"message"===t.type?(s.push(t),this.setState({messages:s})):"close"===t.type&&(s.push(t),this.setState({users:t.connections,messages:s}))}},{key:"sendMessage",value:function(){this.socket.send(JSON.stringify({type:"message",msg:this.state.inputValue}))}},{key:"render",value:function(){return React.createElement("div",{className:"wrapper"},React.createElement("div",{className:"wrapper-app"},React.createElement("p",{className:"text-chat"},"Live Chat"),React.createElement(_messages2["default"],{list:this.state.messages,time:this.state.time,log:this.state.log}),React.createElement(_send2["default"],{updateValue:this.updateValue,inputValue:this.state.inputValue,sendMessage:this.sendMessage})),React.createElement(_users2["default"],{users:this.state.users}))}}]),t}(React.Component);ReactDOM.render(React.createElement(ChatApp,null),app);